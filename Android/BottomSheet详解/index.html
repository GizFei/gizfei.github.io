<!-- - pageTitle += ' [ ' + config.title + ' ]'--><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><title>BottomSheet详解</title><link rel="icon" href="/images/favicon.png"><link rel="stylesheet" href="/css/bootstrap.min.css"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css"><link rel="stylesheet" href="/css/bootstrap.min.css"><link rel="stylesheet" href="/css/mdb.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.13.1/styles/atom-one-light.css"><link rel="stylesheet" href="/css/giz_markdown.css"><link rel="stylesheet" href="/css/giz_style.css"><link rel="stylesheet" href="/css/util.css"><meta name="generator" content="Hexo 6.0.0"></head><body><nav class="navbar navbar-main mb-3"><div class="container"><div class="navbar-brand"><a href="/"><img src="/images/logo.png" alt="清夕的小屋" height="36"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">主页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" href="/about">关于</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" title="访问我的Github" href="https://github.com/gizfei"><i class="fab fa-github"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><!-- 完整的文章--><!-- page指的是"Document"--><style media="(max-width: 768px)">.col-left .card:first-child{
  display: none;
}</style><div class="container-fluid"><div class="row mt-4 mb-5"><!-- 左侧信息--><div class="col-xl-3 col-lg-3 col-md-4 col-12 col-left"><div class="card widget light-shadow mb-4"><div class="card-body"><nav class="level mb-2"><div class="level-item text-center"><div><img class="rounded-circle" height="112" width="112" src="/images/avatar.png" alt="GizAvatar"><p class="block font-4x my-1">清夕</p><p class="font-2x mb-2">愿挥毫方寸，仍有诗情万里。</p></div></div></nav><nav class="level is-mobile mb-2"><div class="level-item text-center m-0"><div><p class="heading">文章</p><p class="title"><a class="a-normal" href="/archives">21</a></p></div></div><div class="level-item text-center m-0"><div><p class="heading">类别</p><p class="title"><a class="a-normal" href="/categories">9</a></p></div></div><div class="level-item text-center m-0"><div><p class="heading">标签</p><p class="title"><a class="a-normal" href="/tags">24</a></p></div></div></nav></div></div><div class="card light-shadow mb-4"><div class="card-body"><div class="menu"><h3 class="menu-label mb-2">目录</h3><div id="toc-div"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B3%E7%B3%BB"><span class="toc-text">关系</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BottomSheetBehavior"><span class="toc-text">BottomSheetBehavior</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8"><span class="toc-text">使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E8%A1%8C%E4%B8%BA"><span class="toc-text">获取行为</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B9%E6%B3%95"><span class="toc-text">方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#BottomSheetCallback"><span class="toc-text">BottomSheetCallback</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BottomSheetDialog"><span class="toc-text">BottomSheetDialog</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E2%80%94%E2%80%94%E5%B8%83%E5%B1%80%E6%96%87%E4%BB%B6"><span class="toc-text">使用——布局文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E2%80%94%E2%80%94%E4%BB%A3%E7%A0%81%E6%96%87%E4%BB%B6"><span class="toc-text">使用——代码文件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BottomSheetDialogFragment"><span class="toc-text">BottomSheetDialogFragment</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%A8%E6%B3%95%E4%B8%80%E2%80%94%E2%80%94%E6%8A%AB%E7%9D%80Fragment%E5%A4%96%E8%A1%A3%E7%9A%84BottomSheetDialog"><span class="toc-text">用法一——披着Fragment外衣的BottomSheetDialog</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%A8%E6%B3%95%E4%BA%8C%E2%80%94%E2%80%94%E7%9C%9F%E6%AD%A3%E7%9A%84Fragment"><span class="toc-text">用法二——真正的Fragment</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%EF%BC%9A%E9%80%9A%E8%BF%87%E8%AE%BE%E7%BD%AEstyle%E5%AE%9E%E7%8E%B0%E5%9C%86%E8%A7%92%E6%A0%B7%E5%BC%8F"><span class="toc-text">扩展：通过设置style实现圆角样式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%88%E6%9E%9C%E5%9B%BE"><span class="toc-text">效果图</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-text">参考</span></a></li></ol></li></ol></li></ol></div></div></div></div></div><!-- 正文--><div class="col-xl-9 col-lg-9 col-md-8 col-12"><div class="card rounded-8 light-shadow full-article"><div class="view overlay rounded-8"><img class="card-img-top" src="/thumbnails/BottomSheet.png" alt="BottomSheet详解" style="object-fit: cover"></div><div class="card-body article"><div class="level font-2-5x article-meta is-mobile"><div class="level-left"><time class="level-item grey-text mr-3" datetime="2019-02-03T13:27:20.000Z">2019/2/3 下午9:27:20</time><p class="mr-3 mb-0"><a class="grey-text" href="/categories/Android/">Android</a></p><span class="level-item grey-text">约41分钟读完 （6076词）</span></div></div><h1 class="title mt-3 mb-3" style="font-weight: 600; font-size: 2.4rem" id="BottomSheet详解">BottomSheet详解</h1><div class="description mb-3 font-2-5x">BottomSheet、BottomSheetDialog、BottomSheetDialogFragment用法介绍。</div><div class="content font-3-5x"><h3 id="关系"><a href="#关系" class="headerlink" title="关系"></a>关系</h3><ol>
<li><code>BottomSheet</code>不是真正存在的类，而是一种称呼，表示该种控件类型，参照Google翻译，本文以下称之为“底页”，就是从屏幕底部弹出的工具条。与之对应是<code>BottomSheetBehavior</code>的行为类，它需要附属某个控件使用。该行为性质包括：<ul>
<li>可以从底部弹出</li>
<li>可以上下拖拽布局</li>
<li>可以单击淡黑色遮罩隐藏/关闭</li>
</ul>
</li>
<li><code>BottomSheetDialog</code>继承<code>Dialog</code>，是一种对话框，它是拥有<code>BottomSheetBehavior</code>行为的对话框，从而实现从底部弹出和上下拉伸的效果。</li>
<li><code>BottomSheetDialogFragment</code>是包含<code>BottomSheetDialog</code>的片段（<code>Fragment</code>），所以它可以同时利用<code>Fragment</code>的特点和<code>BottomSheet</code>这一交互效果。</li>
</ol>
<span id="more"></span>
<h3 id="BottomSheetBehavior"><a href="#BottomSheetBehavior" class="headerlink" title="BottomSheetBehavior"></a>BottomSheetBehavior</h3><h4 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h4><p>在xml布局文件中与<code>CoordinatorLayout</code>配合使用。如下设置后，<code>NestedScrollView</code>具有<code>BottomSheetBehavior</code>的性质，且一开始就显示在布局中，初始的显示高度为<code>peekHeight</code>值。背景没有淡黑色遮罩，可以上下拖拽。</p>
<ul>
<li><p>关键语句<code>app:layout_behavior=&quot;@string/bottom_sheet_behavior&quot;</code>。</p>
</li>
<li><p><code>NestedScrollView</code>的子视图只能有一个。</p>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">android.support.design.widget.CoordinatorLayout</span></span><br><span class="hljs-tag">    <span class="hljs-attr">xmlns:android</span>=<span class="hljs-string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">xmlns:app</span>=<span class="hljs-string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">&quot;match_parent&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">&quot;match_parent&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:fitsSystemWindows</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">android.support.v4.widget.NestedScrollView</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:id</span>=<span class="hljs-string">&quot;@+id/bottom_sheet&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">&quot;match_parent&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">&quot;wrap_content&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">app:behavior_hideable</span>=<span class="hljs-string">&quot;true&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">app:behavior_peekHeight</span>=<span class="hljs-string">&quot;50dp&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">app:layout_behavior</span>=<span class="hljs-string">&quot;@string/bottom_sheet_behavior&quot;</span>&gt;</span><br>        <br>        <span class="hljs-comment">&lt;!--内部布局--&gt;</span><br>        <br>    <span class="hljs-tag">&lt;/<span class="hljs-name">android.support.v4.widget.NestedScrollView</span>&gt;</span><br>    <br><span class="hljs-tag">&lt;/<span class="hljs-name">android.support.design.widget.CoordinatorLayout</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>上述代码中有两个属性值得注意。</p>
<ul>
<li><code>app:behavior_hideable</code>：当我们上下拖拽时，布局是否可以全部隐藏。如果设置为真，那么你向下滑完之后，布局会被隐藏起来，然后就滑不出来了。。。（除非你写了按钮之类的逻辑控制它的行为）所以要谨慎。</li>
<li><code>app:behavior_peekHeight</code>：是当底页关闭的时候，底部我们能看到的高度，默认是0不可见。</li>
</ul>
<h4 id="获取行为"><a href="#获取行为" class="headerlink" title="获取行为"></a>获取行为</h4><p>在布局文件中声明之后，就可以在代码中获取行为了。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 获取视图</span><br>View = findViewById(R.id.bottom_sheet);<br><span class="hljs-comment">// 获取行为</span><br><span class="hljs-type">BottomSheetBehavior</span> <span class="hljs-variable">behavior</span> <span class="hljs-operator">=</span> BottomSheetBehavior.from(view);<br></code></pre></td></tr></table></figure>
<h4 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h4><p>行为的一些常用的方法。</p>
<table>
<thead>
<tr>
<th>方法名</th>
<th>用法示例</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>setHideable</code></td>
<td>setHideable(true)</td>
<td>对应<code>app:behavior_hideable</code>属性</td>
</tr>
<tr>
<td><code>setPeekHeight</code></td>
<td>setPeekHeight(500)</td>
<td>对应<code>app:behavior_peekHeight</code>属性</td>
</tr>
<tr>
<td><code>setBottomSheetCallback</code></td>
<td>/</td>
<td>设置监听回调</td>
</tr>
<tr>
<td><code>setState</code></td>
<td>setState(BottomSheetBehavior.STATE_EXPANDED)</td>
<td>设置底页状态</td>
</tr>
</tbody>
</table>
<h4 id="BottomSheetCallback"><a href="#BottomSheetCallback" class="headerlink" title="BottomSheetCallback"></a>BottomSheetCallback</h4><p>底页的监听回调事件。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java">behavior.setBottomSheetCallback(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BottomSheetBehavior</span>.BottomSheetCallback() &#123;<br>	<span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onStateChanged</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> View bottomSheet, <span class="hljs-type">int</span> newState)</span><br>    &#123;<br>        <span class="hljs-comment">//监听BottomSheet状态的改变</span><br>    &#125;<br>	<span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onSlide</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> View bottomSheet, <span class="hljs-type">float</span> slideOffset)</span><br>    &#123;<br>        <span class="hljs-comment">//监听拖拽中的回调，根据slideOffset可以做一些动画</span><br>    &#125;<br>&#125;);<br></code></pre></td></tr></table></figure>
<p>底页行为一共有五种状态。</p>
<ul>
<li><p>STATE_HIDDEN: 隐藏状态。默认是false，可通过<code>app:behavior_hideable</code>属性设置。</p>
</li>
<li><p>STATE_COLLAPSED: 折叠关闭状态。可通过<code>app:behavior_peekHeight</code>来设置显示的高度，peekHeight默认是0。</p>
</li>
<li><p>STATE_DRAGGING: 被拖拽状态</p>
</li>
<li><p>STATE_SETTLING: 拖拽松开之后到达终点位置（collapsed or expanded）前的状态。</p>
</li>
<li><p>STATE_EXPANDED: 完全展开的状态。</p>
</li>
</ul>
<h3 id="BottomSheetDialog"><a href="#BottomSheetDialog" class="headerlink" title="BottomSheetDialog"></a>BottomSheetDialog</h3><p>这是具有底页行为性质的对话框，不需要与<code>CoordinatorLayout</code>配合使用。弹出时，背景为出现一层淡黑色遮罩。需要相关逻辑控制它的弹出。</p>
<h4 id="使用——布局文件"><a href="#使用——布局文件" class="headerlink" title="使用——布局文件"></a>使用——布局文件</h4><p>设计<code>BottomSheetDialog</code>内部的视图。Xml可以不用被<code>CoordinatorLayout</code>包裹，但是还是推荐实用推荐的滑动控件<code>NestedScrollView</code>。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">android.support.v4.widget.NestedScrollView</span></span><br><span class="hljs-tag">    <span class="hljs-attr">xmlns:android</span>=<span class="hljs-string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">&quot;match_parent&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">&quot;match_parent&quot;</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- 内部视图 --&gt;</span><br>    <br><span class="hljs-tag">&lt;/<span class="hljs-name">android.support.v4.widget.NestedScrollView</span>&gt;</span><br></code></pre></td></tr></table></figure>
<h4 id="使用——代码文件"><a href="#使用——代码文件" class="headerlink" title="使用——代码文件"></a>使用——代码文件</h4><p>使用上述的布局文件，假设名称为<code>layout_bsd</code>。可以获取行为实现自定义。要注意的是从视图的父视图（<code>(View)view.getParent()</code>）获取底页行为，否则会报错：</p>
<blockquote>
<p>The view is not a child of CoordinatorLayout.</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">BottomSheetDialog</span> <span class="hljs-variable">dialog</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BottomSheetDialog</span>(context);<br><span class="hljs-type">View</span> <span class="hljs-variable">view</span> <span class="hljs-operator">=</span> getLayoutInflater.inflate(R.layout.layout_bsd, <span class="hljs-literal">null</span>);<br>dialog.setContentView(view);<br><span class="hljs-comment">// 获取行为，用于自定义</span><br><span class="hljs-type">BottomSheetBehavior</span> <span class="hljs-variable">behavior</span> <span class="hljs-operator">=</span> BottomSheetBehavior.from((View)view.getParent());<br>dialog.show();<br></code></pre></td></tr></table></figure>
<h3 id="BottomSheetDialogFragment"><a href="#BottomSheetDialogFragment" class="headerlink" title="BottomSheetDialogFragment"></a>BottomSheetDialogFragment</h3><p>有两种用法。</p>
<ul>
<li>当作中装了一个底页对话框的<code>Fragment</code>。实际是与底页对话框的作用和使用方法是相同的。</li>
<li>具有底页行为的<code>Fragment</code>。</li>
</ul>
<h4 id="用法一——披着Fragment外衣的BottomSheetDialog"><a href="#用法一——披着Fragment外衣的BottomSheetDialog" class="headerlink" title="用法一——披着Fragment外衣的BottomSheetDialog"></a>用法一——披着<code>Fragment</code>外衣的<code>BottomSheetDialog</code></h4><p>重写<code>BottomSheetDialogFragment</code>中的<code>onCreateDialog</code>方法。可以看到和上面<code>BottomSheetDialog</code>的代码是相同的。同样可以在中间获取行为用于自定义。要注意是子视图的扩充用到的是<code>View.inflate</code>的静态方法，否则会报错。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> Dialog <span class="hljs-title function_">onCreateDialog</span><span class="hljs-params">(Bundle savedInstanceState)</span><br>&#123;<br>    <span class="hljs-type">BottomSheetDialog</span> <span class="hljs-variable">dialog</span> <span class="hljs-operator">=</span> (BottomSheetDialog) <span class="hljs-built_in">super</span>.onCreateDialog(savedInstanceState);<br>    <span class="hljs-type">View</span> <span class="hljs-variable">view</span> <span class="hljs-operator">=</span> View.inflate(getContext(), R.layout.dialog_bottom_sheet, <span class="hljs-literal">null</span>);<br>    dialog.setContentView(view);<br>    mBehavior = BottomSheetBehavior.from((View) view.getParent());<br>    <span class="hljs-keyword">return</span> dialog;<br>&#125;<br></code></pre></td></tr></table></figure>
<h4 id="用法二——真正的Fragment"><a href="#用法二——真正的Fragment" class="headerlink" title="用法二——真正的Fragment"></a>用法二——真正的<code>Fragment</code></h4><p>重写<code>BottomSheetDialogFragment</code>中的<code>onCreateView</code>方法。代码与<code>Fragment</code>的常规写法相同。不过不好的一点是不容易获取行为。如果要强行获取行为的话，可以使用以下的代码。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onStart</span><span class="hljs-params">()</span> &#123;<br>	<span class="hljs-built_in">super</span>.onStart();<br>    <span class="hljs-type">Dialog</span> <span class="hljs-variable">dialog</span> <span class="hljs-operator">=</span> getDialog();<br>    <br>    <span class="hljs-keyword">if</span> (dialog != <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-type">View</span> <span class="hljs-variable">bottomSheet</span> <span class="hljs-operator">=</span> dialog.findViewById(R.id.design_bottom_sheet);<br>        bottomSheet.getLayoutParams().height = ViewGroup.LayoutParams.MATCH_PARENT;<br>    &#125;<br>    <span class="hljs-type">View</span> <span class="hljs-variable">view</span> <span class="hljs-operator">=</span> getView();<br>    view.post(() -&gt; &#123;<br>        <span class="hljs-type">View</span> <span class="hljs-variable">parent</span> <span class="hljs-operator">=</span> (View) view.getParent();<br>        CoordinatorLayout.<span class="hljs-type">LayoutParams</span> <span class="hljs-variable">params</span> <span class="hljs-operator">=</span> (CoordinatorLayout.LayoutParams) (parent).getLayoutParams();<br>        CoordinatorLayout.<span class="hljs-type">Behavior</span> <span class="hljs-variable">behavior</span> <span class="hljs-operator">=</span> params.getBehavior();<br>        <span class="hljs-type">BottomSheetBehavior</span> <span class="hljs-variable">bottomSheetBehavior</span> <span class="hljs-operator">=</span> (BottomSheetBehavior) behavior;<br>        bottomSheetBehavior.setPeekHeight(view.getMeasuredHeight());<br>        ((View)bottomSheet.getParent()).setBackgroundColor(Color.TRANSPARENT);<br>    &#125;);<br>&#125;<br></code></pre></td></tr></table></figure>
<p>但是如果这两个方法都重写了，那么以<code>onCreateView</code>里的视图为准，<code>onCreateDialog</code>会被覆盖。</p>
<h3 id="扩展：通过设置style实现圆角样式"><a href="#扩展：通过设置style实现圆角样式" class="headerlink" title="扩展：通过设置style实现圆角样式"></a>扩展：通过设置style实现圆角样式</h3><p>如下设置好之后，在创建<code>BottomSheetDialog</code>时传入样式。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">BottomSheetDialog</span> <span class="hljs-variable">dialog</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BottomSheetDialog</span>(context, R.style.BottomSheetDialog);<br></code></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--styles.xml文件--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;BottomSheet&quot;</span> <span class="hljs-attr">parent</span>=<span class="hljs-string">&quot;Widget.Design.BottomSheet.Modal&quot;</span>&gt;</span><span class="language-xml"></span><br><span class="language-xml">    <span class="hljs-comment">&lt;!--背景，顶部两个圆角--&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">item</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;android:background&quot;</span>&gt;</span>@drawable/bg_bottom_sheet<span class="hljs-tag">&lt;/<span class="hljs-name">item</span>&gt;</span></span><br><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;BottomSheetDialog&quot;</span> <span class="hljs-attr">parent</span>=<span class="hljs-string">&quot;Theme.Design.Light.BottomSheetDialog&quot;</span>&gt;</span><span class="language-xml"></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">item</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;android:windowIsFloating&quot;</span>&gt;</span>false<span class="hljs-tag">&lt;/<span class="hljs-name">item</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-comment">&lt;!--底部弹出条的样式（相当于背景）--&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">item</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;bottomSheetStyle&quot;</span>&gt;</span>@style/BottomSheet<span class="hljs-tag">&lt;/<span class="hljs-name">item</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-comment">&lt;!--状态栏颜色--&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">item</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;android:statusBarColor&quot;</span>&gt;</span>@color/transparent<span class="hljs-tag">&lt;/<span class="hljs-name">item</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-comment">&lt;!--导航条颜色--&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">item</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;android:navigationBarColor&quot;</span>&gt;</span>@color/white<span class="hljs-tag">&lt;/<span class="hljs-name">item</span>&gt;</span></span><br><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><br><span class="hljs-comment">&lt;!--以下是@drawable/bg_bottom_sheet--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">shape</span> <span class="hljs-attr">xmlns:android</span>=<span class="hljs-string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">android:shape</span>=<span class="hljs-string">&quot;rectangle&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">corners</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:topLeftRadius</span>=<span class="hljs-string">&quot;16dp&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:topRightRadius</span>=<span class="hljs-string">&quot;16dp&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">corners</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">solid</span> <span class="hljs-attr">android:color</span>=<span class="hljs-string">&quot;@android:color/white&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">padding</span> <span class="hljs-attr">android:top</span>=<span class="hljs-string">&quot;16dp&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:left</span>=<span class="hljs-string">&quot;8dp&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">android:right</span>=<span class="hljs-string">&quot;8dp&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">shape</span>&gt;</span><br></code></pre></td></tr></table></figure>
<h3 id="效果图"><a href="#效果图" class="headerlink" title="效果图"></a>效果图</h3><p><img src="/images/BottomSheet.png" alt="BottomSheet"></p>
<h5 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h5><hr>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/0a7383e0ad0f">BottomSheet、BottomSheetDialog使用详解</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/36030879/bottomsheetdialogfragment-how-to-set-expanded-height-or-min-top-offset">StackOverflow</a></p>
</li>
</ul>
</div></div></div><div class="card prev-next mt-4 mb-4"><div class="level post-navigation is-mobile"><div class="level-start"><a class="level level-item" href="/%E7%94%9F%E6%B4%BB/%E9%99%A4%E5%A4%95/"><i class="level-item fas fa-chevron-left mr-3"></i><span class="level-item">除夕</span></a></div><div class="level-end"><a class="level level-item" href="/Markdown/Markdown%E8%AF%AD%E6%B3%95%E5%8F%82%E8%80%83/"><span class="level-item">Markdown语法参考</span><i class="level-item fas fa-chevron-right ml-3"></i></a></div></div></div><div class="card light-shadow"><div class="card-body" id="valine-space"></div></div><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><script>new Valine({
  el: '#valine-space',
  app_id: 'iXuP1TEqBypVIOuKLLC5IWyP-gzGzoHsz',
  app_key: 'VmIIPmlfoIqQoV5CigCxDufj',
  placeholder: '(●ˇ∀ˇ●)说两句~',
  avatar: 'monsterid',
  meta: ['nick'],
  pageSize: 6,
  visitor: true
});</script></div></div></div><!--article#post//h1= page.title
//!= page.content--><!--#paginator!= paginator()--><footer class="footer mt-3"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo mb-2" href="/"><img src="/images/logo.png" alt="GizBlog" height="32"></a><p class="font-2x bold mb-0">© 2019 
Powered by <a href="http://hexo.io/" target="_blank"><span style="color: var(--primary)">Hexo</span></a> & <a target="_blank" rel="noopener" href="https://github.com/ppoffice/hexo-theme-icarus"><span style="color: var(--primary)">Icarus</span></a> & <a target="_blank" rel="noopener" href="http://github.com/gizfei"><span style="color: var(--primary)">Giz</span></a></p></div><div class="level-end"><div class="field"><p class="control"><a class="a-btn" data-toggle="tooltip" date-placement="top" title="访问我的Github" target="_blank" rel="noopener" href="https://github.com/gizfei"><i class="fab fa-github"></i></a></p><p class="control"><a class="a-btn" data-toggle="tooltip" date-placement="top" title="访问我的微博" target="_blank" rel="noopener" href="http://weibo.com/gizfei"><i class="fab fa-weibo"></i></a></p><p class="control"><a class="a-btn" data-toggle="tooltip" date-placement="top" title="和我说两句吗" target="_blank" rel="noopener" href="http://wpa.qq.com/msgrd?v=3&amp;uin=1150847818&amp;site=qq&amp;menu=yes"><i class="fab fa-qq"></i></a></p></div></div></div></div></footer><a id="back-to-top"><i class="fas fa-angle-up"></i></a><script src="/js/jquery-3.3.1.min.js"></script><script src="/js/popper.min.js"></script><script src="/js/bootstrap.min.js"></script><script src="/js/mdb.min.js"></script><script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.13.1/build/highlight.min.js"></script><script src="/js/pace.min.js"></script><script src="/js/animation.js"></script><script src="/js/giz_js.js"></script></body></html>