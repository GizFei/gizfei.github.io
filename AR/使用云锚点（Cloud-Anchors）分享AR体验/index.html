<!-- - pageTitle += ' [ ' + config.title + ' ]'--><!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><title>使用云锚点（Cloud Anchors）分享AR体验</title><link rel="icon" href="/images/favicon.png"><link rel="stylesheet" href="/css/bootstrap.min.css"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css"><link rel="stylesheet" href="/css/bootstrap.min.css"><link rel="stylesheet" href="/css/mdb.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.13.1/styles/atom-one-light.css"><link rel="stylesheet" href="/css/giz_markdown.css"><link rel="stylesheet" href="/css/giz_style.css"><link rel="stylesheet" href="/css/util.css"></head><body><nav class="navbar navbar-main mb-3"><div class="container"><div class="navbar-brand"><a href="/"><img src="/images/logo.png" alt="清夕的小屋" height="36"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">主页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" href="/about">关于</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" title="访问我的Github" href="https://github.com/gizfei"><i class="fab fa-github"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><!-- 完整的文章--><!-- page指的是"Document"--><style media="(max-width: 768px)">.col-left .card:first-child{
  display: none;
}</style><div class="container-fluid"><div class="row mt-4 mb-5"><!-- 左侧信息--><div class="col-xl-3 col-lg-3 col-md-4 col-12 col-left"><div class="card widget light-shadow mb-4"><div class="card-body"><nav class="level mb-2"><div class="level-item text-center"><div><img class="rounded-circle" height="112" width="112" src="/images/avatar.png" alt="GizAvatar"><p class="block font-4x my-1">清夕</p><p class="font-2x mb-2">愿挥毫方寸，仍有诗情万里。</p></div></div></nav><nav class="level is-mobile mb-2"><div class="level-item text-center m-0"><div><p class="heading">文章</p><p class="title"><a class="a-normal" href="/archives">20</a></p></div></div><div class="level-item text-center m-0"><div><p class="heading">类别</p><p class="title"><a class="a-normal" href="/categories">9</a></p></div></div><div class="level-item text-center m-0"><div><p class="heading">标签</p><p class="title"><a class="a-normal" href="/tags">24</a></p></div></div></nav></div></div><div class="card light-shadow mb-4"><div class="card-body"><div class="menu"><h3 class="menu-label mb-2">目录</h3><div id="toc-div"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#云锚点是什么？"><span class="toc-text">云锚点是什么？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#云锚如何工作？"><span class="toc-text">云锚如何工作？</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#建立并托管锚点"><span class="toc-text">建立并托管锚点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#解析之前托管的锚点"><span class="toc-text">解析之前托管的锚点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#云锚点隐私要求"><span class="toc-text">云锚点隐私要求</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数据存储和访问限制"><span class="toc-text">数据存储和访问限制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#良好用户体验的最佳做法"><span class="toc-text">良好用户体验的最佳做法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#开始使用"><span class="toc-text">开始使用</span></a></li></ol></div></div></div></div></div><!-- 正文--><div class="col-xl-9 col-lg-9 col-md-8 col-12"><div class="card rounded-8 light-shadow full-article"><div class="view overlay rounded-8"><img class="card-img-top" src="/thumbnails/cloud_anchors.png" alt="使用云锚点（Cloud Anchors）分享AR体验" style="height: 360px; object-fit: cover"></div><div class="card-body article"><div class="level font-2-5x article-meta is-mobile"><div class="level-left"><time class="level-item grey-text mr-3" datetime="2020-01-11T02:29:05.000Z">2020-1-11 10:29:05</time><p class="mr-3 mb-0"><a class="grey-text" href="/categories/AR/">AR</a></p><span class="level-item grey-text">约30分钟读完 （4436词）</span></div></div><h1 class="title mt-3 mb-3" style="font-weight: 600; font-size: 2.4rem" id="使用云锚点（Cloud Anchors）分享AR体验">使用云锚点（Cloud Anchors）分享AR体验</h1><div class="description mb-3 font-2-5x">ARCore中云锚点的内容介绍。</div><div class="content font-3-5x"><p><img src="https://www.gstatic.com/devrel-devsite/prod/v18acaed6c9e1965881c7cfa6f3f9f69e7c37603f6d253114168821ce9e70c645/developers/images/favicon.png" alt="img">原文地址：<a href="https://developers.google.com/ar/develop/java/cloud-anchors/overview-android#how-hosted" target="_blank" rel="noopener">https://developers.google.com/ar/develop/java/cloud-anchors/overview-android#how-hosted</a></p>
<p>使用云锚点创建Android和iOS用户可以共享的多人或协作式AR体验。</p>
<h2 id="云锚点是什么？"><a href="#云锚点是什么？" class="headerlink" title="云锚点是什么？"></a>云锚点是什么？</h2><p>通过使用云锚点，您的应用程序允许用户将虚拟对象添加到AR场景中。然后，多个用户可以从共享的物理空间中的不同位置同时查看这些对象并与之交互。</p>
<p>云锚点的行为和功能与<a href="https://developers.google.com/ar/develop/developer-guides/anchors" target="_blank" rel="noopener">锚点</a>类似，但不同之处在于它们托管在ARCore云锚点服务上。该托管使用户可以共享体验。</p>
<h2 id="云锚如何工作？"><a href="#云锚如何工作？" class="headerlink" title="云锚如何工作？"></a>云锚如何工作？</h2><p>为了实现这些共享体验，ARCore连接到<a href="https://console.cloud.google.com/apis/library/arcorecloudanchor.googleapis.com" target="_blank" rel="noopener">ARCore云锚点服务</a>，以<strong>托管</strong>和<strong>解析</strong>锚点。这需要有效的网络连接。</p>
<p>托管和解析涉及以下步骤：</p>
<ol>
<li>用户在自身所处环境中创建本地锚点。</li>
<li>在<strong>托管</strong>期间，ARCore将锚点的数据上传到ARCore云锚点服务，该服务会返回该锚点的唯一ID。</li>
<li>该应用程序将唯一ID分发给其他用户。</li>
<li>在<strong>解析</strong>期间，具有唯一ID的用户可以使用ARCore云锚点服务重新创建相同的锚点。</li>
</ol>
<p><img src="/images/cloud-anchor-exchange.png" alt="cloud-anchor-exchange"></p>
<p>要使用云锚点创建良好的用户体验，重要的是要详细了解托管过程，以便您可以调整应用程序的设计以帮助用户成功使用。</p>
<h3 id="建立并托管锚点"><a href="#建立并托管锚点" class="headerlink" title="建立并托管锚点"></a>建立并托管锚点</h3><p>为了建立和托管锚点，ARCore使用锚点（兴趣中心[the center of interest]）周围空间的3D特征图（feature map）。要获取此特征图，设备的后置摄像头必须在主机呼叫（<a href="https://developers.google.com/ar/reference/java/arcore/reference/com/google/ar/core/Session#hostCloudAnchor(com.google.ar.core.Anchor" target="_blank" rel="noopener"><code>hostCloudAnchor()</code></a>)）前30秒内从不同的视角和位置映射兴趣中心及其周围的环境。</p>
<p>从ARCore SDK 1.12开始，此主机调用使ARCore将来自设备相机的最近30秒内的选定可视数据上传到ARCore 云锚点服务，该服务处理可视数据以构建3D特征图并返回云锚点 ID。</p>
<p><strong>正确创建3D特征图对于获得出色的用户体验至关重要。</strong>否则，映射质量可能会受到限制，从而使解析更加困难。为了提高特征图质量，我们建议用户界面（UI）明确指示用户围绕锚点从不同的视角和位置移动设备，从而在兴趣中心周围尽可能多地绘制特征图。</p>
<p>托管云锚点：</p>
<ol>
<li><strong>在会话开始</strong>之前，请<strong>等待几秒钟，</strong>以使跟踪时间稳定下来，然后再尝试托管锚点。</li>
<li>在选择用于放置锚点的位置时，请尝试<strong>查找具有易于区分的视觉特征的区域</strong>。例如，具有视觉特征的角落。</li>
<li><strong>将后置设备相机指向感兴趣的中心</strong>，即您要放置锚点的位置周围的区域。</li>
<li>保持相机瞄准兴趣中心的位置，并大致保持设备与兴趣中心之间的物理距离。同时，<strong>移动设备以从不同的视角和位置映射环境信息最多30秒</strong>。在空间中四处走动，同时使设备摄像机对准兴趣中心的位置，这将使您能够从各个角度捕获兴趣区域的视觉特征，从而使解析更加牢固。</li>
<li>调用<a href="https://developers.google.com/ar/reference/java/arcore/reference/com/google/ar/core/Session#hostCloudAnchor(com.google.ar.core.Anchor" target="_blank" rel="noopener"><code>hostCloudAnchor()</code></a>)函数发起托管请求。</li>
<li>ARCore通过ARCore Cloud Anchor API上传视觉数据、设备姿势和锚点姿势。</li>
<li>ARCore 云锚点服务创建空间的3D特征图，并为设备的锚返回唯一的云锚点 ID。</li>
<li>使用<a href="https://developers.google.com/ar/reference/java/arcore/reference/com/google/ar/core/Anchor.CloudAnchorState#enum-values" target="_blank" rel="noopener"><code>Anchor.CloudAnchorState</code></a>检查托管锚点（包括错误处理消息）的状态。</li>
</ol>
<p>ARCore 云锚点服务会创建空间的3D特征图，并将唯一的云锚点 ID返回到设备。</p>
<video src="/videos/cloud-anchor-part-1.mp4"></video>

<p>锚点应该被托管着。</p>
<p><a href="https://developers.google.com/ar/reference/java/arcore/reference/com/google/ar/core/Anchor.CloudAnchorState#enum-values" target="_blank" rel="noopener"><code>Anchor.CloudAnchorState</code></a> 使您可以检查托管锚点的状态（包括错误处理消息）。</p>
<h3 id="解析之前托管的锚点"><a href="#解析之前托管的锚点" class="headerlink" title="解析之前托管的锚点"></a>解析之前托管的锚点</h3><p>当同一环境中的另一个用户将其设备摄像头指向托管云锚点的区域时，解析请求（<a href="https://developers.google.com/ar/reference/java/arcore/reference/com/google/ar/core/Session#resolveCloudAnchor(java.lang.String" target="_blank" rel="noopener"><code>resolveCloudAnchor()</code></a>)）使ARCore 云锚点服务定期将场景中的视觉特征与创建的3D特征图进行比较。 ARCore用于确定用户相对于云锚点的位置和方向。这就是为什么在托管请求之前的30秒内尽可能在兴趣中心周围映射环境很重要。</p>
<p>您可以依次启动多个云锚点的解析。最多可以同时解析20个云锚点。</p>
<p>使用与托管设备相同或不同的设备，请按照以下步骤解析托管锚点。</p>
<ol>
<li><p><strong>在会话开始</strong>之前，请<strong>等待几秒钟，</strong>以使跟踪时间稳定下来，然后再尝试解析锚点。</p>
</li>
<li><p>在与托管锚相同的环境中，<strong>扫描原始的兴趣区域</strong>，确保：</p>
<ul>
<li>设备摄像头对地图区域的视图清晰</li>
<li>设备摄像头到托管锚点的距离与最初托管锚点的设备相近。</li>
</ul>
</li>
<li><p>调用<a href="https://developers.google.com/ar/reference/java/arcore/reference/com/google/ar/core/Session#resolveCloudAnchor(java.lang.String" target="_blank" rel="noopener"><code>resolveCloudAnchor()</code></a>)并使用 <a href="https://developers.google.com/ar/reference/java/arcore/reference/com/google/ar/core/Anchor.CloudAnchorState#enum-values" target="_blank" rel="noopener"><code>Anchor.CloudAnchorState</code></a>来<strong>定期检查解决请求的状态</strong>。</p>
<p>如果您想取消请求，请调用<a href="https://developers.google.com/ar/reference/java/arcore/reference/com/google/ar/core/Anchor#detach(" target="_blank" rel="noopener"><code>detach()</code></a>)。</p>
</li>
<li><p>ARCore不断轮询ARCore Cloud Anchor API，将可视数据发送到ARCore 云锚点服务。</p>
</li>
<li><p>ARCore 云锚点服务将场景中的视觉特征与创建的3D特征图进行比较。找到匹配项后，<strong>服务器将返回云锚点的姿势</strong>。</p>
<p>云锚点应该可以解析了。测试一下吧。</p>
</li>
</ol>
<p><a href="https://developers.google.com/ar/reference/java/arcore/reference/com/google/ar/core/Anchor.CloudAnchorState#enum-values" target="_blank" rel="noopener"><code>Anchor.CloudAnchorState</code></a>使您可以检查托管锚的状态（包括错误处理消息）。当您使用完云锚点后，请调用<a href="https://developers.google.com/ar/reference/java/arcore/reference/com/google/ar/core/Anchor#detach(" target="_blank" rel="noopener"><code>detach()</code></a>)。</p>
<video src="/videos/cloud-anchor-part-2.mp4"></video>

<h3 id="云锚点隐私要求"><a href="#云锚点隐私要求" class="headerlink" title="云锚点隐私要求"></a>云锚点隐私要求</h3><p>为了符合我们更新的使用ARCore SDK 1.12或更高版本的隐私要求，您<strong>必须</strong>显着披露云锚点的使用。有关详细信息，请参阅<a href="https://developers.google.com/ar/distribute/privacy-requirements" target="_blank" rel="noopener">用户隐私要求</a>。</p>
<h3 id="数据存储和访问限制"><a href="#数据存储和访问限制" class="headerlink" title="数据存储和访问限制"></a>数据存储和访问限制</h3><p>云锚点具有以下数据存储和访问限制：</p>
<ul>
<li><strong>云锚点可以在托管后的24小时之内被解析</strong>。</li>
<li>托管锚点时上传到云的可视数据将在24小时之内被丢弃。</li>
<li>根据3D特征图在服务器上解析锚点。</li>
<li>之前上传的视觉数据永远不会发送到用户的设备。</li>
</ul>
<h3 id="良好用户体验的最佳做法"><a href="#良好用户体验的最佳做法" class="headerlink" title="良好用户体验的最佳做法"></a>良好用户体验的最佳做法</h3><p>以下最佳做法可帮助创建良好的云锚点用户体验。</p>
<ul>
<li>请记住，发起主机呼叫会使用前30秒的映射来创建3D特征图。确保您应用的用户界面已将此考虑在内。</li>
<li>考虑在用户围绕兴趣中心移动时创建对用户来说有趣或可能有用的动作或特征，并且这也可以完成创建正确的3D特征图的任务。</li>
<li>避免在某些类型的表面上托管或解析云锚点。<ul>
<li>为了获得最佳效果，用户应避免使用反射性表面或无视觉特征的表面，例如空白、光滑的白色墙壁。</li>
</ul>
</li>
<li>确保房间内的照明充足。</li>
</ul>
<h2 id="开始使用"><a href="#开始使用" class="headerlink" title="开始使用"></a>开始使用</h2><p>要开始使用云锚点，请参阅<a href="https://developers.google.com/ar/develop/java/cloud-anchors/quickstart-android" target="_blank" rel="noopener">云锚点快速入门</a>。</p>
<p>如果您不熟悉锚点，请参阅<a href="https://developers.google.com/ar/develop/developer-guides/anchors" target="_blank" rel="noopener">使用锚点</a>以获取介绍。</p>
</div></div></div><div class="card prev-next mt-4 mb-4"><div class="level post-navigation is-mobile"><div class="level-start"></div><div class="level-end"><a class="level level-item" href="/不是诗/一个人的电影/"><span class="level-item">一个人的电影</span><i class="level-item fas fa-chevron-right ml-3"></i></a></div></div></div><div class="card light-shadow"><div class="card-body" id="valine-space"></div></div><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><script>new Valine({
  el: '#valine-space',
  app_id: 'iXuP1TEqBypVIOuKLLC5IWyP-gzGzoHsz',
  app_key: 'VmIIPmlfoIqQoV5CigCxDufj',
  placeholder: '(●ˇ∀ˇ●)说两句~',
  avatar: 'monsterid',
  meta: ['nick'],
  pageSize: 6,
  visitor: true
});</script></div></div></div><!--article#post//h1= page.title
//!= page.content--><!--#paginator!= paginator()--><footer class="footer mt-3"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo mb-2" href="/"><img src="/images/logo.png" alt="GizBlog" height="32"></a><p class="font-2x bold mb-0">© 2019 
Powered by <a href="http://hexo.io/" target="_blank"><span style="color: var(--primary)">Hexo</span></a> & <a href="https://github.com/ppoffice/hexo-theme-icarus"><span style="color: var(--primary)">Icarus</span></a> & <a href="http://github.com/gizfei"><span style="color: var(--primary)">Giz</span></a></p></div><div class="level-end"><div class="field"><p class="control"><a class="a-btn" data-toggle="tooltip" date-placement="top" title="访问我的Github" href="https://github.com/gizfei"><i class="fab fa-github"></i></a></p><p class="control"><a class="a-btn" data-toggle="tooltip" date-placement="top" title="访问我的微博" href="http://weibo.com/gizfei"><i class="fab fa-weibo"></i></a></p><p class="control"><a class="a-btn" data-toggle="tooltip" date-placement="top" title="和我说两句吗" href="http://wpa.qq.com/msgrd?v=3&amp;uin=1150847818&amp;site=qq&amp;menu=yes"><i class="fab fa-qq"></i></a></p></div></div></div></div></footer><a id="back-to-top"><i class="fas fa-angle-up"></i></a><script src="/js/jquery-3.3.1.min.js"></script><script src="/js/popper.min.js"></script><script src="/js/bootstrap.min.js"></script><script src="/js/mdb.min.js"></script><script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.13.1/build/highlight.min.js"></script><script src="/js/pace.min.js"></script><script src="/js/animation.js"></script><script src="/js/giz_js.js"></script></body></html>